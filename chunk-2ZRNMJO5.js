import{j as G,n as O,o as q,r as z,s as I}from"./chunk-F725LVN7.js";import{Bb as u,Dc as F,Fb as x,Gb as k,Hb as A,Ib as l,Jb as M,Kb as C,Lb as g,Mb as S,Nb as E,Ob as D,_a as r,dc as $,gc as L,ic as T,la as b,ob as y,oc as c,tb as N,xc as n}from"./chunk-AGYQYQRX.js";function V(i,d){if(i&1&&(b(),D(0,"path")),i&2){let e=d.$implicit;$("fill",e.fill),u("d",e.d)}}var J=()=>[.3],Z=()=>[0,20],K=()=>({preserveDrawingBuffer:!0}),j=()=>["!=","cluster",!0];function Q(i,d){if(i&1&&g(0,"showcase-cluster-point",6),i&2){let e=d.$implicit;l("properties",e.properties)}}var W=(()=>{class i{constructor(){this.properties=F(),this.counts=n(()=>{let e=this.properties();return[e?.mag1,e?.mag2,e?.mag3,e?.mag4,e?.mag5]}),this.data=n(()=>{let e=this.counts(),o=[],t=0;for(let s=0;s<e.length;s++)o.push(t),t+=e[s];return{offsets:o,total:t}}),this.total=n(()=>this.data().total),this.offsets=n(()=>this.data().offsets),this.fontSize=n(()=>{let e=this.total();return e>=1e3?22:e>=100?20:e>=10?18:16}),this.font=n(()=>`${this.fontSize()}px sans-serif`),this.r=n(()=>{let e=this.total();return e>=1e3?50:e>=100?32:e>=10?24:18}),this.r0=n(()=>Math.round(this.r()*.6)),this.w=n(()=>this.r()*2),this.viewbox=n(()=>`0 0 ${this.w()} ${this.w()}`),this.textTransform=n(()=>`translate(${this.r()}, ${this.r()})`),this.segments=n(()=>{let e=this.counts(),o=this.offsets(),t=this.total(),s=this.r(),h=this.r0(),p=[];for(let a=0;a<e.length;a++)p.push(this.donutSegment({r:s,r0:h},o[a]/t,(o[a]+e[a])/t,m[a]));return p}),this.totalString=n(()=>this.total().toLocaleString())}donutSegment({r:e,r0:o},t,s,h){s-t===1&&(s-=1e-5);let p=2*Math.PI*(t-.25),a=2*Math.PI*(s-.25),f=Math.cos(p),v=Math.sin(p),w=Math.cos(a),P=Math.sin(a),_=s-t>.5?1:0;return{d:`M ${e+o*f} ${e+o*v} L ${e+e*f} ${e+e*v} A ${e} ${e} 0 ${_} 1 ${e+e*w} ${e+e*P} L ${e+o*w} ${e+o*P} A ${o} ${o} 0 ${_} 0 ${e+o*f} ${e+o*v}`,fill:h}}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=y({type:i,selectors:[["showcase-cluster-point"]],inputs:{properties:[1,"properties"]},decls:6,vars:10,consts:[["text-anchor","middle"],[3,"fill"],["fill","white"],["dominant-baseline","central"]],template:function(o,t){o&1&&(b(),S(0,"svg",0),k(1,V,1,3,":svg:path",1,x),D(3,"circle",2),S(4,"text",3),L(5),E()()),o&2&&($("font",t.font()),u("width",t.w())("height",t.w())("viewbox",t.viewbox()),r(),A(t.segments()),r(2),u("cx",t.r())("cy",t.r())("r",t.r0()),r(),u("transform",t.textTransform()),r(),T(" ",t.totalString()," "))},encapsulation:2,changeDetection:0})}}return i})(),m=["#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c"],B=["<",["get","mag"],2],H=["all",[">=",["get","mag"],2],["<",["get","mag"],3]],R=["all",[">=",["get","mag"],3],["<",["get","mag"],4]],U=["all",[">=",["get","mag"],4],["<",["get","mag"],5]],X=[">=",["get","mag"],5],ne=(()=>{class i{constructor(){this.clusterProperties={mag1:["+",["case",B,1,0]],mag2:["+",["case",H,1,0]],mag3:["+",["case",R,1,0]],mag4:["+",["case",U,1,0]],mag5:["+",["case",X,1,0]]},this.circlePaint={"circle-color":["case",B,m[0],H,m[1],R,m[2],U,m[3],m[4]],"circle-opacity":.6,"circle-radius":12},this.labelLayout={"text-field":["number-format",["get","mag"],{"min-fraction-digits":1,"max-fraction-digits":1}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10},this.labelPaint={"text-color":["case",["<",["get","mag"],3],"black","white"]}}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=y({type:i,selectors:[["showcase-demo"]],decls:6,vars:17,consts:[[3,"mapStyle","zoom","center","canvasContextAttributes"],["id","earthquakes","data","https://maplibre.org/maplibre-gl-js/docs/assets/earthquakes.geojson",3,"cluster","clusterRadius","clusterProperties"],["source","earthquakes"],["mglClusterPoint",""],["id","earthquake_circle","type","circle","source","earthquakes",3,"filter","paint"],["id","earthquake_label","type","symbol","source","earthquakes",3,"filter","layout","paint"],[3,"properties"]],template:function(o,t){o&1&&(M(0,"mgl-map",0),g(1,"mgl-geojson-source",1),M(2,"mgl-markers-for-clusters",2),N(3,Q,1,1,"ng-template",3),C(),g(4,"mgl-layer",4)(5,"mgl-layer",5),C()),o&2&&(l("mapStyle","https://api.maptiler.com/maps/streets/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL")("zoom",c(12,J))("center",c(13,Z))("canvasContextAttributes",c(14,K)),r(),l("cluster",!0)("clusterRadius",80)("clusterProperties",t.clusterProperties),r(3),l("filter",c(15,j))("paint",t.circlePaint),r(),l("filter",c(16,j))("layout",t.labelLayout)("paint",t.labelPaint))},dependencies:[q,G,I,z,W,O],styles:[`[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}
/*# sourceMappingURL=examples-UPBTEGPO.css.map */`],changeDetection:0})}}return i})();export{ne as ClusterHtmlComponent,W as ClusterPointComponent};
//# sourceMappingURL=chunk-2ZRNMJO5.js.map
