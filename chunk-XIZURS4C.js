import{j as O,n as q,o as z,r as E,s as I}from"./chunk-J37FTXPB.js";import{Ab as g,Bc as T,Eb as k,Fb as A,Gb as L,Hb as l,Ib as f,Jb as y,Kb as p,_b as S,ab as c,ac as D,cc as F,ec as G,kc as m,lb as C,oa as b,qb as x,uc as o}from"./chunk-6JYJQWWP.js";function N(n,s){if(n&1&&(b(),p(0,"path")),n&2){let d=s.$implicit;S("fill",d.fill),g("d",d.d)}}var V=()=>[.3],J=()=>[0,20],Z=()=>({preserveDrawingBuffer:!0}),j=()=>["!=","cluster",!0];function K(n,s){if(n&1&&p(0,"showcase-cluster-point",6),n&2){let d=s.$implicit;l("properties",d.properties)}}var Q=(()=>{let s=class s{constructor(){this.properties=T(),this.counts=o(()=>{let t=this.properties();return[t?.mag1,t?.mag2,t?.mag3,t?.mag4,t?.mag5]}),this.data=o(()=>{let t=this.counts(),i=[],e=0;for(let a=0;a<t.length;a++)i.push(e),e+=t[a];return{offsets:i,total:e}}),this.total=o(()=>this.data().total),this.offsets=o(()=>this.data().offsets),this.fontSize=o(()=>{let t=this.total();return t>=1e3?22:t>=100?20:t>=10?18:16}),this.font=o(()=>`${this.fontSize()}px sans-serif`),this.r=o(()=>{let t=this.total();return t>=1e3?50:t>=100?32:t>=10?24:18}),this.r0=o(()=>Math.round(this.r()*.6)),this.w=o(()=>this.r()*2),this.viewbox=o(()=>`0 0 ${this.w()} ${this.w()}`),this.textTransform=o(()=>`translate(${this.r()}, ${this.r()})`),this.segments=o(()=>{let t=this.counts(),i=this.offsets(),e=this.total(),a=this.r(),v=this.r0(),h=[];for(let r=0;r<t.length;r++)h.push(this.donutSegment({r:a,r0:v},i[r]/e,(i[r]+t[r])/e,u[r]));return h}),this.totalString=o(()=>this.total().toLocaleString())}donutSegment({r:t,r0:i},e,a,v){a-e===1&&(a-=1e-5);let h=2*Math.PI*(e-.25),r=2*Math.PI*(a-.25),M=Math.cos(h),$=Math.sin(h),w=Math.cos(r),P=Math.sin(r),_=a-e>.5?1:0;return{d:`M ${t+i*M} ${t+i*$} L ${t+t*M} ${t+t*$} A ${t} ${t} 0 ${_} 1 ${t+t*w} ${t+t*P} L ${t+i*w} ${t+i*P} A ${i} ${i} 0 ${_} 0 ${t+i*M} ${t+i*$}`,fill:v}}};s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=C({type:s,selectors:[["showcase-cluster-point"]],inputs:{properties:[1,"properties"]},decls:6,vars:10,consts:[["text-anchor","middle"],[3,"fill"],["fill","white"],["dominant-baseline","central"]],template:function(i,e){i&1&&(b(),f(0,"svg",0),A(1,N,1,3,":svg:path",1,k),p(3,"circle",2),f(4,"text",3),F(5),y()()),i&2&&(S("font",e.font()),g("width",e.w())("height",e.w())("viewbox",e.viewbox()),c(),L(e.segments()),c(2),g("cx",e.r())("cy",e.r())("r",e.r0()),c(),g("transform",e.textTransform()),c(),G(" ",e.totalString()," "))},encapsulation:2,changeDetection:0});let n=s;return n})(),u=["#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c"],B=["<",["get","mag"],2],R=["all",[">=",["get","mag"],2],["<",["get","mag"],3]],U=["all",[">=",["get","mag"],3],["<",["get","mag"],4]],H=["all",[">=",["get","mag"],4],["<",["get","mag"],5]],W=[">=",["get","mag"],5],st=(()=>{let s=class s{constructor(){this.clusterProperties={mag1:["+",["case",B,1,0]],mag2:["+",["case",R,1,0]],mag3:["+",["case",U,1,0]],mag4:["+",["case",H,1,0]],mag5:["+",["case",W,1,0]]},this.circlePaint={"circle-color":["case",B,u[0],R,u[1],U,u[2],H,u[3],u[4]],"circle-opacity":.6,"circle-radius":12},this.labelLayout={"text-field":["number-format",["get","mag"],{"min-fraction-digits":1,"max-fraction-digits":1}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10},this.labelPaint={"text-color":["case",["<",["get","mag"],3],"black","white"]}}};s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=C({type:s,selectors:[["showcase-demo"]],decls:6,vars:18,consts:[[3,"zoom","center","canvasContextAttributes"],["id","earthquakes","data","https://maplibre.org/maplibre-gl-js/docs/assets/earthquakes.geojson",3,"cluster","clusterRadius","clusterProperties"],["source","earthquakes"],["mglClusterPoint",""],["id","earthquake_circle","type","circle","source","earthquakes",3,"filter","paint"],["id","earthquake_label","type","symbol","source","earthquakes",3,"filter","layout","paint"],[3,"properties"]],template:function(i,e){i&1&&(f(0,"mgl-map",0),p(1,"mgl-geojson-source",1),f(2,"mgl-markers-for-clusters",2),x(3,K,1,1,"ng-template",3),y(),p(4,"mgl-layer",4)(5,"mgl-layer",5),y()),i&2&&(D("https://api.maptiler.com/maps/streets/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL"),l("zoom",m(13,V))("center",m(14,J))("canvasContextAttributes",m(15,Z)),c(),l("cluster",!0)("clusterRadius",80)("clusterProperties",e.clusterProperties),c(3),l("filter",m(16,j))("paint",e.circlePaint),c(),l("filter",m(17,j))("layout",e.labelLayout)("paint",e.labelPaint))},dependencies:[z,O,I,E,Q,q],styles:[`[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}
/*# sourceMappingURL=examples-UPBTEGPO.css.map */`],changeDetection:0});let n=s;return n})();export{st as ClusterHtmlComponent,Q as ClusterPointComponent};
//# sourceMappingURL=chunk-XIZURS4C.js.map
