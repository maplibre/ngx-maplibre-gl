{
  "version": 3,
  "sources": ["projects/showcase/src/app/demo/examples/live-update-image-srource.component.ts"],
  "sourcesContent": ["import { HttpClient } from '@angular/common/http';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  computed,\n  inject,\n  linkedSignal,\n} from '@angular/core';\nimport { toSignal } from '@angular/core/rxjs-interop';\nimport {\n  MapComponent,\n  ImageSourceComponent,\n  LayerComponent,\n} from '@maplibre/ngx-maplibre-gl';\nimport { interval, map, shareReplay, startWith, switchMap } from 'rxjs';\n\n@Component({\n  selector: 'showcase-demo',\n  template: `\n    <mgl-map\n      [mapStyle]=\"\n        'https://api.maptiler.com/maps/streets/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL'\n      \"\n      [center]=\"center()\"\n      [zoom]=\"[14]\"\n      movingMethod=\"jumpTo\"\n      [canvasContextAttributes]=\"{preserveDrawingBuffer: true}\"\n    >\n      <mgl-image-source\n        id=\"test_source\"\n        [url]=\"url()\"\n        [coordinates]=\"coordinates()\"\n      />\n\n      <mgl-layer\n        id=\"test_layer\"\n        source=\"test_source\"\n        type=\"raster\"\n        [paint]=\"{ 'raster-fade-duration': 0 }\"\n      />\n    </mgl-map>\n  `,\n  styleUrls: ['./examples.css'],\n  imports: [MapComponent, ImageSourceComponent, LayerComponent],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LiveUpdateImageSourceComponent {\n  private readonly httpClient = inject(HttpClient);\n  private readonly size = 0.001;\n\n  private readonly hike$ = this.httpClient.get<GeoJSON.FeatureCollection<GeoJSON.LineString>>('assets/data/hike.geo.json')\n    .pipe(\n      map(hike => {\n        const points = hike.features[0].geometry!.coordinates;\n        const coordinates = points.map((c: number[]) => this.makeRectangle(c));\n        return { points, coordinates };\n      }),\n      shareReplay({ bufferSize: 1, refCount: true })\n    );\n\n  private readonly data$ = this.hike$.pipe(\n    switchMap(d =>\n      interval(250).pipe(\n        startWith(0),\n        map(i => {\n          const index = (i + 1) % d.coordinates.length;\n          const center = d.points[0];\n          const coordinates = d.coordinates[index];\n          return { index, center, coordinates };\n        }),\n      )\n    )\n  );\n\n  private readonly dataSig = toSignal(this.data$, { initialValue: { index: 0, center: [0, 0], coordinates: this.makeRectangle([0, 0]) } });\n\n  readonly coordinates = computed(() => {\n    const d = this.dataSig();\n    return d.coordinates;\n  });\n\n  readonly center = computed(() => {\n    const d = this.dataSig();\n    return d.center;\n  });\n\n  readonly url = linkedSignal({\n    source: this.dataSig,\n    computation: () => (Math.random() < 0.5 ? 'assets/red.png' : 'assets/blue.png'),\n  });\n\n  private makeRectangle([long, lat]: number[]): number[][] {\n    return [\n      [long, lat],\n      [long + this.size, lat],\n      [long + this.size, lat - this.size],\n      [long, lat - this.size],\n    ];\n  }\n}\n"],
  "mappings": "8UA8CaA,GAA8B,IAAA,CAArC,MAAOA,CAA8B,CA9B3CC,aAAA,CA+BmB,KAAAC,WAAaC,EAAOC,CAAU,EAC9B,KAAAC,KAAO,KAEP,KAAAC,MAAQ,KAAKJ,WAAWK,IAAmD,2BAA2B,EACpHC,KACCC,EAAIC,GAAO,CACT,IAAMC,EAASD,EAAKE,SAAS,CAAC,EAAEC,SAAUC,YACpCA,EAAcH,EAAOF,IAAKM,GAAgB,KAAKC,cAAcD,CAAC,CAAC,EACrE,MAAO,CAAEJ,OAAAA,EAAQG,YAAAA,CAAW,CAC9B,CAAC,EACDG,EAAY,CAAEC,WAAY,EAAGC,SAAU,EAAI,CAAE,CAAC,EAGjC,KAAAC,MAAQ,KAAKd,MAAME,KAClCa,EAAUC,GACRC,EAAS,GAAG,EAAEf,KACZgB,EAAU,CAAC,EACXf,EAAIgB,GAAI,CACN,IAAMC,GAASD,EAAI,GAAKH,EAAER,YAAYa,OAChCC,EAASN,EAAEX,OAAO,CAAC,EACnBG,EAAcQ,EAAER,YAAYY,CAAK,EACvC,MAAO,CAAEA,MAAAA,EAAOE,OAAAA,EAAQd,YAAAA,CAAW,CACrC,CAAC,CAAC,CACH,CACF,EAGc,KAAAe,QAAUC,EAAS,KAAKV,MAAO,CAAEW,aAAc,CAAEL,MAAO,EAAGE,OAAQ,CAAC,EAAG,CAAC,EAAGd,YAAa,KAAKE,cAAc,CAAC,EAAG,CAAC,CAAC,CAAC,CAAE,CAAE,EAE9H,KAAAF,YAAckB,EAAS,IACpB,KAAKH,QAAO,EACbf,WACV,EAEQ,KAAAc,OAASI,EAAS,IACf,KAAKH,QAAO,EACbD,MACV,EAEQ,KAAAK,IAAMC,EAAY,CACzBC,OAAQ,KAAKN,QACbO,YAAaA,IAAOC,KAAKC,OAAM,EAAK,GAAM,iBAAmB,iBAAkB,CAAA,EAGzEtB,cAAc,CAACuB,EAAMC,CAAG,EAAW,CACzC,MAAO,CACL,CAACD,EAAMC,CAAG,EACV,CAACD,EAAO,KAAKlC,KAAMmC,CAAG,EACtB,CAACD,EAAO,KAAKlC,KAAMmC,EAAM,KAAKnC,IAAI,EAClC,CAACkC,EAAMC,EAAM,KAAKnC,IAAI,CAAC,CAE3B,iDApDWL,EAA8B,CAAA,+BAA9BA,EAA8ByC,UAAA,CAAA,CAAA,eAAA,CAAA,EAAAC,MAAA,EAAAC,KAAA,GAAAC,OAAA,CAAA,CAAA,eAAA,SAAA,EAAA,WAAA,SAAA,OAAA,yBAAA,EAAA,CAAA,KAAA,cAAA,EAAA,MAAA,aAAA,EAAA,CAAA,KAAA,aAAA,SAAA,cAAA,OAAA,SAAA,EAAA,OAAA,CAAA,EAAAC,SAAA,SAAAC,EAAAC,EAAA,CAAAD,EAAA,IA3BvCE,EAAA,EAAA,UAAA,CAAA,EASEC,EAAA,EAAA,mBAAA,CAAA,EAIE,EAAA,YAAA,CAAA,EAQJC,EAAA,SApBEC,EAAA,WAAA,wFAAA,EAEC,SAAAJ,EAAAnB,OAAA,CAAA,EACkB,OAAAwB,EAAA,EAAAC,CAAA,CAAA,EACN,0BAAAD,EAAA,EAAAE,CAAA,CAAA,EAMXC,EAAA,EAAAJ,EAAA,MAAAJ,EAAAd,IAAA,CAAA,EAAa,cAAAc,EAAAjC,YAAA,CAAA,EAQbyC,EAAA,EAAAJ,EAAA,QAAAC,EAAA,EAAAI,CAAA,CAAA,kBAKIC,EAAcC,EAAsBC,CAAc,EAAAC,OAAA,CAAA;kDAAA,EAAAC,gBAAA,CAAA,CAAA,CAAA,SAGjD7D,CAA8B,GAAA",
  "names": ["LiveUpdateImageSourceComponent", "constructor", "httpClient", "inject", "HttpClient", "size", "hike$", "get", "pipe", "map", "hike", "points", "features", "geometry", "coordinates", "c", "makeRectangle", "shareReplay", "bufferSize", "refCount", "data$", "switchMap", "d", "interval", "startWith", "i", "index", "length", "center", "dataSig", "toSignal", "initialValue", "computed", "url", "linkedSignal", "source", "computation", "Math", "random", "long", "lat", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "\u0275\u0275elementStart", "\u0275\u0275element", "\u0275\u0275elementEnd", "\u0275\u0275property", "\u0275\u0275pureFunction0", "_c0", "_c1", "\u0275\u0275advance", "_c2", "MapComponent", "ImageSourceComponent", "LayerComponent", "styles", "changeDetection"]
}
