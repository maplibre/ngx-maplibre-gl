import{j as O,n as q,o as z,r as I,s as j}from"./chunk-JSMU6KCP.js";import{Cc as s,Fb as g,Jb as k,Jc as G,Kb as A,Lb as E,Mb as l,Nb as S,Ob as D,Pb as h,Qb as $,Rb as L,Sb as w,bb as c,hc as C,kc as T,mc as F,pa as y,sc as m,tb as M,yb as x}from"./chunk-WAGYCGY3.js";function J(n,o){if(n&1&&(y(),w(0,"path")),n&2){let d=o.$implicit;C("fill",d.fill),g("d",d.d)}}var Z=()=>[.3],K=()=>[0,20],Q=()=>({preserveDrawingBuffer:!0}),B=()=>["!=","cluster",!0];function W(n,o){if(n&1&&h(0,"showcase-cluster-point",6),n&2){let d=o.$implicit;l("properties",d.properties)}}var X=(()=>{let o=class o{constructor(){this.properties=G(),this.counts=s(()=>{let e=this.properties();return[e?.mag1,e?.mag2,e?.mag3,e?.mag4,e?.mag5]}),this.data=s(()=>{let e=this.counts(),i=[],t=0;for(let a=0;a<e.length;a++)i.push(t),t+=e[a];return{offsets:i,total:t}}),this.total=s(()=>this.data().total),this.offsets=s(()=>this.data().offsets),this.fontSize=s(()=>{let e=this.total();return e>=1e3?22:e>=100?20:e>=10?18:16}),this.font=s(()=>`${this.fontSize()}px sans-serif`),this.r=s(()=>{let e=this.total();return e>=1e3?50:e>=100?32:e>=10?24:18}),this.r0=s(()=>Math.round(this.r()*.6)),this.w=s(()=>this.r()*2),this.viewbox=s(()=>`0 0 ${this.w()} ${this.w()}`),this.textTransform=s(()=>`translate(${this.r()}, ${this.r()})`),this.segments=s(()=>{let e=this.counts(),i=this.offsets(),t=this.total(),a=this.r(),f=this.r0(),u=[];for(let r=0;r<e.length;r++)u.push(this.donutSegment({r:a,r0:f},i[r]/t,(i[r]+e[r])/t,p[r]));return u}),this.totalString=s(()=>this.total().toLocaleString())}donutSegment({r:e,r0:i},t,a,f){a-t===1&&(a-=1e-5);let u=2*Math.PI*(t-.25),r=2*Math.PI*(a-.25),v=Math.cos(u),b=Math.sin(u),P=Math.cos(r),N=Math.sin(r),_=a-t>.5?1:0;return{d:`M ${e+i*v} ${e+i*b} L ${e+e*v} ${e+e*b} A ${e} ${e} 0 ${_} 1 ${e+e*P} ${e+e*N} L ${e+i*P} ${e+i*N} A ${i} ${i} 0 ${_} 0 ${e+i*v} ${e+i*b}`,fill:f}}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=M({type:o,selectors:[["showcase-cluster-point"]],inputs:{properties:[1,"properties"]},decls:6,vars:10,consts:[["text-anchor","middle"],[3,"fill"],["fill","white"],["dominant-baseline","central"]],template:function(i,t){i&1&&(y(),$(0,"svg",0),A(1,J,1,3,":svg:path",1,k),w(3,"circle",2),$(4,"text",3),T(5),L()()),i&2&&(C("font",t.font()),g("width",t.w())("height",t.w())("viewbox",t.viewbox()),c(),E(t.segments()),c(2),g("cx",t.r())("cy",t.r())("r",t.r0()),c(),g("transform",t.textTransform()),c(),F(" ",t.totalString()," "))},encapsulation:2,changeDetection:0});let n=o;return n})(),p=["#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c"],R=["<",["get","mag"],2],U=["all",[">=",["get","mag"],2],["<",["get","mag"],3]],H=["all",[">=",["get","mag"],3],["<",["get","mag"],4]],V=["all",[">=",["get","mag"],4],["<",["get","mag"],5]],Y=[">=",["get","mag"],5],ne=(()=>{let o=class o{constructor(){this.clusterProperties={mag1:["+",["case",R,1,0]],mag2:["+",["case",U,1,0]],mag3:["+",["case",H,1,0]],mag4:["+",["case",V,1,0]],mag5:["+",["case",Y,1,0]]},this.circlePaint={"circle-color":["case",R,p[0],U,p[1],H,p[2],V,p[3],p[4]],"circle-opacity":.6,"circle-radius":12},this.labelLayout={"text-field":["number-format",["get","mag"],{"min-fraction-digits":1,"max-fraction-digits":1}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10},this.labelPaint={"text-color":["case",["<",["get","mag"],3],"black","white"]}}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=M({type:o,selectors:[["showcase-demo"]],decls:6,vars:17,consts:[[3,"mapStyle","zoom","center","canvasContextAttributes"],["id","earthquakes","data","https://maplibre.org/maplibre-gl-js/docs/assets/earthquakes.geojson",3,"cluster","clusterRadius","clusterProperties"],["source","earthquakes"],["mglClusterPoint",""],["id","earthquake_circle","type","circle","source","earthquakes",3,"filter","paint"],["id","earthquake_label","type","symbol","source","earthquakes",3,"filter","layout","paint"],[3,"properties"]],template:function(i,t){i&1&&(S(0,"mgl-map",0),h(1,"mgl-geojson-source",1),S(2,"mgl-markers-for-clusters",2),x(3,W,1,1,"ng-template",3),D(),h(4,"mgl-layer",4)(5,"mgl-layer",5),D()),i&2&&(l("mapStyle","https://api.maptiler.com/maps/streets/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL")("zoom",m(12,Z))("center",m(13,K))("canvasContextAttributes",m(14,Q)),c(),l("cluster",!0)("clusterRadius",80)("clusterProperties",t.clusterProperties),c(3),l("filter",m(15,B))("paint",t.circlePaint),c(),l("filter",m(16,B))("layout",t.labelLayout)("paint",t.labelPaint))},dependencies:[z,O,j,I,X,q],styles:[`[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}
/*# sourceMappingURL=examples-UPBTEGPO.css.map */`],changeDetection:0});let n=o;return n})();export{ne as ClusterHtmlComponent,X as ClusterPointComponent};
//# sourceMappingURL=chunk-ETWUENFY.js.map
